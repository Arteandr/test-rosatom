# Тестовое задание на предстажировку Case Lab ML

## Содержание
- [Тестовое задание на предстажировку Case Lab ML](#тестовое-задание-на-предстажировку-case-lab-ml)
  - [Содержание](#содержание)
  - [Используемые технологии](#используемые-технологии)
  - [Описание работы](#описание-работы)
    - [Описание процесса обучения](#описание-процесса-обучения)
  - [Оценка точности на тестовой выборке](#оценка-точности-на-тестовой-выборке)
    - [Модель регрессии (1/10)](#модель-регрессии-110)
    - [Модель классификации (pos/neg)](#модель-классификации-posneg)
  - [Структура проекта](#структура-проекта)
  - [Запуск приложения](#запуск-приложения)
    - [Conda](#conda)
  - [Скриншот приложения](#скриншот-приложения)
## Используемые технологии

- Python
- PyTorch
- Pandas
- CatBoost
- scikit-learn
- nltk
- Django
- sqlite

## Описание работы

### Описание процесса обучения

1. Каждый комментарий из тренировочного и тестового датасета был предобработан, он был приведен к нижнему регистру, из него была удалена пунктуация, цифры, он был токенизирован, были удалены стоп-слова, лемматизирован (`experiments/preprocessing.ipynb`). 
2. Используя модель `intfloat/multilingual-e5-large` были получены embedding-и предобработанных комментариев (`experiments/embeddings.ipynb`)
3. 1. Для присвоения статуса комментарию (положительный/отрицательный) был обучен классификатор на основе `CatBoost` (`experiments/classifier.ipynb`). Параметры были подобраны с помощью `GridSearch`.
   2. Для присвоения рейтинга комментарию (1/10) был обучен регрессор на основе `CatBoost` (`experiments/regressor.ipynb`). Параметры были подобраны с помощью `GridSearch`

![alt text](https://i.ibb.co/r7mKjdn/image.png)
## Оценка точности на тестовой выборке

### Модель регрессии (1/10)

![<img src="" />](https://i.ibb.co/p09LfzD/image.png)

### Модель классификации (pos/neg)

![alt text](https://i.ibb.co/WxDDCMV/image.png)

## Структура проекта

```bash
├── README.md
├── app # Django приложение (UI)
├── datasets # Директория для хранения датасета
├── environment.yml
├── experiments # Директория с .ipynb файлами
│   ├── classifier.ipynb # Обучение модели классификатора
│   ├── embeddings.ipynb # Генерация embedding-ов из предобработанных комментариев
│   ├── regressions.ipynb # Обучение модели регресси (Оценка от 1 до 10)
│   └── preprocessing.ipynb # Описание предобработки комментариев
└── files # Директория с обученными моделями
    ├── classification_model.cbm # Модель классификации (pos/neg)
    ├── regression_model.cbm # Модель регрессии (1/10)
    └── select_class.pkl # Выбор признаков (SelectKBest)
```

## Запуск приложения
### Conda

```bash
$ conda env create -f environment.yml
```

```bash
$ cd app
```

```bash
$ python manage.py migrate
```

```bash
$ python manage.py runserver
```

## Скриншот приложения

![alt text](https://i.ibb.co/0t7RdBd/image.png)